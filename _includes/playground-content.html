<link rel="stylesheet" href="{{ '/assets/css/challenge_modal.css' | relative_url }}">
<link rel="stylesheet" href="{{ '/assets/css/playground.css' | relative_url }}">

<div class="playground-container">
    <ul class="playground-list">
        <li class="playground-item" data-playground="run-profile">
            <div class="playground-icon">
                <i class="fas fa-chart-line"></i>
            </div>
            <div class="playground-text">
                <h2>Run & Profile</h2>
                <p>Execute your CUDA code and analyze performance metrics</p>
            </div>
        </li>
        
        <li class="playground-item" data-playground="compiler-explorer">
            <div class="playground-icon">
                <i class="fas fa-wrench"></i>
            </div>
            <div class="playground-text">
                <h2>Compiler Explorer</h2>
                <p>Write CUDA code and see the compiled assembly output side-by-side</p>
            </div>
        </li>
    </ul>
</div>

<!-- Compiler Explorer Modal -->
<div id="compilerExplorerModal" class="challenge-modal">
    <div class="challenge-modal-overlay"></div>
    <div class="challenge-modal-content">
        <button class="challenge-modal-close">&times;</button>
        <div class="challenge-modal-body">
            <div class="challenge-details-compiler-explorer-assembly">
                <h2>Assembly Output</h2>
                <div id="assembly-output" class="assembly-editor"></div>
            </div>
          
            <div class="challenge-workspace">
                <div class="challenge-meta-tab">
                    <div class="meta-left">
                        <span class="meta-label">GPU:</span>
                        <select id="gpu-select">
                            <option value="nvidia-rtx-4090">NVIDIA RTX 4090</option>
                            <option value="nvidia-a100">NVIDIA A100</option>
                            <option value="amd-mi250">AMD MI250</option>
                        </select>
                    </div>
                    <div class="meta-right">
                        <div class="stat-item" title="Submissions left">
                            <span id="compiler-submissions-count">0</span>
                            <i class="fas fa-code"></i>
                        </div>
                        <div class="stat-item" title="Hints left">
                            <span id="compiler-hints-count">0</span>
                            <i class="fas fa-lightbulb"></i>
                        </div>
                    </div>
                </div>
                <div id="compiler-monaco-editor"></div>
                <div class="challenge-output-panel">
                    <div class="challenge-output-header">
                            <div class="compiler-options">
                                <label for="compilerFlags">Compiler flags:</label>
                                <input 
                                    type="text" 
                                    id="compilerFlags" 
                                    list="flagSuggestions"
                                    placeholder="-O3 -arch=sm_75"
                                    value="-O3"
                                >
                                <datalist id="flagSuggestions">
                                    <option value="-O0">No optimization</option>
                                    <option value="-O1">Basic optimization</option>
                                    <option value="-O2">Medium optimization</option>
                                    <option value="-O3">Full optimization</option>
                                    <option value="-arch=sm_75">Compute capability 7.5</option>
                                    <option value="-arch=sm_80">Compute capability 8.0</option>
                                    <option value="-arch=sm_86">Compute capability 8.6</option>
                                    <option value="-maxrregcount=32">Max 32 registers per thread</option>
                                    <option value="-Xptxas -v">Verbose PTX assembly</option>
                                </datalist>
                            </div>

                              <div class="challenge-controls">
                                <button id="compiler-saveProgress" class="challenge-save-button">
                                    <i class="fas fa-save"></i>
                                    <span class="save-text">Save</span>
                                </button>
                                <button id="compiler-runCode" class="challenge-run-button">
                                    â–¶ Run
                                    <i class="fas fa-code"></i>
                                </button>
                                </div>
                            </div>
                             <pre id="compiler-output" class="compiler-output"></pre>
                    </div>
                   
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Run & Profile Modal -->
<div id="runProfileModal" class="challenge-modal">
    <div class="challenge-modal-overlay"></div>
    <div class="challenge-modal-content">
        <button class="challenge-modal-close">&times;</button>
        <div class="challenge-modal-body">
             <div class="challenge-details">
                <h2>Analyzed Kernel Execution Time</h2>
                <div id="assembly-output" class="assembly-editor"></div>
            </div>
            
            <div class="challenge-workspace">
                  <!-- Meta tab -->
                <div class="challenge-meta-tab">
                    <div class="meta-left">
                        <span class="meta-label">GPU:</span>
                        <select id="profile-gpu-select">
                            <option value="nvidia-rtx-4090">NVIDIA RTX 4090</option>
                            <option value="nvidia-a100">NVIDIA A100</option>
                            <option value="amd-mi250">AMD MI250</option>
                        </select>
                    </div>
                    <div class="meta-right">
                        <div class="stat-item" title="Submissions left">
                            <span id="profile-submissions-count">0</span>
                            <i class="fas fa-code"></i>
                        </div>
                        <div class="stat-item" title="Hints left">
                            <span id="profile-hints-count">0</span>
                            <i class="fas fa-lightbulb"></i>
                        </div>
                    </div>
                </div>
                <div id="profile-monaco-editor"></div>
                <div class="challenge-output-panel">
                    <div class="challenge-output-header">
                        <h3>Output & Performance Metrics</h3>
                        <div class="challenge-controls">
                             <button id="profileSaveProgress" class="challenge-save-button">
                                <i class="fas fa-save"></i>
                                <span class="save-text">Save</span>
                            </button>
                            <button id="profileRunBtn" class="run-button">
                                Run & Profile <i class="fas fa-play"></i>
                            </button>
                        </div>
                    </div>
                    <pre id="profile-output"></pre>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="{{ '/assets/js/playground.js' | relative_url }}"></script>